Anderson impurity solver based on the cumulant Green's functions method

Solver for the Anderson impurity model using the cumulant Green's functions method (https://arxiv.org/abs/2409.16881)

Pre-requisites and how to install them

. gfortran (https://fortran-lang.org/)
    sudo apt-get install gfortran
. LAPACK   (https://netlib.org/lapack/)
    sudo apt-get install liblapack-dev
. BLAS     (https://netlib.org/blas/)
    sudo apt-get install libblas-dev 

How to compile and run the code

. Compiling
    gfortran -std=legacy -mcmodel=medium -o CGFM_Anderson_impurity_1D.exe CGFM_Anderson_impurity_1D.f90 -llapack -lblas
    After compiling, the module files and the executable will be created.
. Running
    nohup ./CGFM_Anderson_impurity_1D.exe > CGFM_Anderson_impurity_1D.out &
    Using the nohup command, the code runs in the background, freeing up the terminal. To check the execution status, use top.
    While running, the temporary files fort.* are created. They can be removed after execution.
    After running, the output files are created. More information about the output files below.

Description of the important parameters and variables (in order of appearance)

IN MAIN PROGRAM
. LFIN:             DEFINES THE TOTAL NUMBER OF SITES IN THE CHAIN (LFIN-1 CONDUCTION SITES + 1 IMPURITY)
. IZI:              DEFINES ON WHICH SITE THE GREEN'S FUNCTIONS WILL BE CALCULATED (IZI=LFIN MEANS ON THE LAST SITE, WHICH IS THE IMPURITY SITE)
. IDOWN:            DEFINES IF THE DOWN SPIN GREEN'S FUNCTIONS SHOULD BE CALCULATED (IDOWN=0 MEANS UP SPIN ONLY; IDOWN=1 MEANS BOTH SPINS)
. PRINTTRANSITIONS: DEFINES IF THE ATOMIC TRANSITIONS SHOULD BE PRINTED ON THE OUTPUT FILE (PRINTTRANSITIONS=0 MEANS NO; PRINTTRANSITIONS=1 MEANS YES)
. ALLBLOCKS:        ALLBLOCKS DEFINES IF ALL BLOCKS OF THE HAMILTONIAN MATRIX SHOULD BE INCLUDED IN THE CALCULATIONS (ALLBLOCKS=0 ONLY CONSIDERS BLOCKS WHERE THE NUMBER OF ELECTRONS IS EQUAL TO LFIN, LFIN-1 OR LFIN+1; ALLBLOCKS=1 CONSIDERS ALL BLOCKS)
. ACOPtI:           ELECTRON HOPPING TERM BETWEEN SITES OF THE CHAIN
. D:                BANDWIDTH FOR THE ZERO ORDER DENSITY OF STATES
. ACOPparam:        ANDERSON PARAMETER DELTA (THE ANDERSON PARAMETER DEFINES THE ENERGY SCALE)
. ACOPhib:          HYBRIDIZATION V (THE HYBRIDIZATION BETWEEN THE IMPURITY SITE AND THE FIRST CONDUCTION SITE)
. BETAI:            BETA=1/T
. AMUI:             CHEMICAL POTENTIAL MU
. ACOPUI:           STARTING ELECTRONIC CORRELATION U_i FOR THE CORRELATION LOOP
. ACOPUF:           ENDING ELECTRONIC CORRELATION U_f FOR THE CORRELATION LOOP
. ACOPnI:           LOCAL ENERGY E_q OF THE CONDUCTION ELECTRONS
. EFI:              STARTING IMPURITY GATE ENERGY
. EFF:              ENDING IMPURITY GATE ENERGY
. MT:               NUMBER OF POINTS FOR THE IMPURITY GATE ENERGY LOOP
. LT:               NUMBER OF POINTS FOR THE TEMPERATURE LOOP
. TI:               STARTING TEMPERATURE
. TF:               ENDING TEMPERATURE
. NT:               NUMBER OF POINTS FOR THE ELECTRON CORRELATION LOOP
. UI:               STARTING ELECTRON CORRELATION
. UF:               ENDING ELECTRON CORRELATION
. TKHaldane:        KONDO TEMPERATURE T_k AS CALCULATED BY HALDANE
. A:                STARTING FREQUENCY FOR THE OCCUPATION NUMBERS
. B:                ENDING FREQUENCY FOR THE OCCUPATION NUMBERS
. COMPP:            COMPLETENESS NUMBER CALCULATED FROM UP SPIN GREEN'S FUNCTIONS
. SVACP:            VACUUM OCCUPATION NUMBER CALCULATED FROM UP SPIN GREEN'S FUNCTIONS
. SFUP:             UP SPIN OCCUPATION NUMBER CALCULATED FROM UP SPIN GREEN'S FUNCTIONS
. SFDP:             DOWN SPIN OCCUPATION NUMBER CALCULATED FROM UP SPIN GREEN'S FUNCTIONS
. SD2P:             DOUBLE SPIN OCCUPATION NUMBER CALCULATED FROM UP SPIN GREEN'S FUNCTIONS
. COMPN:            COMPLETENESS NUMBER CALCULATED FROM DOWN SPIN GREEN'S FUNCTIONS
. SVACN:            VACUUM OCCUPATION NUMBER CALCULATED FROM DOWN SPIN GREEN'S FUNCTIONS
. SFUN:             UP SPIN OCCUPATION NUMBER CALCULATED FROM DOWN SPIN GREEN'S FUNCTIONS
. SFDN:             DOWN SPIN OCCUPATION NUMBER CALCULATED FROM DOWN SPIN GREEN'S FUNCTIONS
. SD2N:             DOUBLE SPIN OCCUPATION NUMBER CALCULATED FROM DOWN SPIN GREEN'S FUNCTIONS
. FRIED:            FRIEDEL SUM RULE
IN SUBROUTINE OCUP
. NT:               NUMBER OF POINTS FOR THE CALCULATION
. ETTA:             IMAGINARY PART OF THE COMPLEX FREQUENCY
IN SUBROUTINE DENSI2
. NT:               NUMBER OF POINTS FOR THE CALCULATION
. ETTA:             IMAGINARY PART OF THE COMPLEX FREQUENCY
. OI:               STARTING FREQUENCY FOR THE DOS
. OF:               ENDING FREQUENCY FOR THE DOS

Subroutines and functions (in order of appearance)

. PROGRAM AMHUBBARD: Main routine, defines the parameters of the model and calls other subroutines
. OCUP:              calculates the occupation numbers for the infinite chain
. DENSI2:            calculates the density of states for the infinite chain
. GKONDO:            calculates the frequency dependent up spin and down spin Green's functions for the finite chain using the residues (numerators) from MEOCUP and MEOCDOWN, and afterwards calculates the up spin and down spin Green's functions for the infinite chain
. RESIDUOS:          builds the finite chain by iteratively adding site by site
. SIMP:              Simpson integration
. FERM:              real Fermi function
. ZFER:              complex Fermi function
. MEOCUP:            calculates the residues (numerator) of the up spin Green's functions for the finite chain using the Lehmann representation
. MEOCDOWN:          calculates the residues (numerator) of the down spin Green's functions for the finite chain using the Lehmann representation
. LEE:               reads fort.* files that contain information about the Fock space from previous iteration to be used in the current iteration
. TRANSFNEW:         transfers information about the Fock space from the current iteration to be used in the next iteration
. DEALLOC_IGSIS:     deallocates memory used to store charge and spin of the Hamiltonian blocks of the current iteration
. TCUPES1:           calculates the up spin creation operator of the current iteration
. TCDOWNES1:         calculates the down spin creation operator of the current iteration
. TCUPSIS:           calculates the up spin creation operator of the whole system
. TCDOWNSIS:         calculates the down spin creation operator of the whole system
. THSIS:             calculates the non local elements of the Hamiltonian matrix, adds them to the local elements and diagonalizes the Hamiltonian matrix
. CONECTIONS:        defines which Hamiltonian blocks connect to each other and to creation operators 
. ESTRUCTURA:        defines the size, charge, and spin of Hamiltonian blocks
. DEALLOC_ESP1:      deallocates memory used to store information about the Fock space of the current iteration
. MULTI:             calculates the local elements of the Hamiltonian matrix
. VALIN:             defines the operators and Hamiltonian for a single site

Output files

. CGFM_Anderson_impurity_1D.out
    Main output file. The file contains information about the execution of the program, such as: input parameters; Hamiltonian blocks with their respective charge, spin, and eigenvalues; lowest eigenvalue; partition function; among others.
. 20241012_aocup_LFIN=2.dat
    Output file for the occupation numbers. The name contains the date the program was run (in YYYY-MM-DD format) and the number of sites in the chain. The file contains the temperature in column 1, the impurity gate energy divided by the Anderson parameter in column 2, the chemical potential in column 3, the electron correlation in column 4, the Friedel sum rule in column 5, the total vacuum occupation number in column 6, the total up spin occupation number in column 7, the total down spin occupation number in column 8, the total double spin occupation number in column 9, the total completeness number in column 10, and the total occupation number in column 11.
. 20241012_adensity_LFIN=2.dat
    Output file for the density of states. The name contains the date the program was run (in YYYY-MM-DD format) and the number of sites in the chain. The file contains the frequency in column 1, the up spin density of states in column 2, and the down spin density of states in column 3.






. NAS PRÓXIMAS VERSÕES DO CÓDIGO, DEFINIR OI, OF, NT, E ETTA PARA DENSI2 E OCUP NO PROGRAMA PRINCIPAL

. Troquei  na densi2
  RFN(J)=-CC*DIMAG(VZGFN(J))*PI*0.01D0
  por
  RFP(J)=-CC*DIMAG(VZGFP(J))*PI*ACOPparam
  e
  RFN(J)=-CC*DIMAG(VZGFN(J))*PI*0.01D0
  por
  RFN(J)=-CC*DIMAG(VZGFN(J))*PI*ACOPparam

. Incluí a impressão do RFN(J) e removi a impressão do RMAJ(J) na densi2







